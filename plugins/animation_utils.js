!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=55)}([function(e,t,n){var r=n(4)(Object,"create");e.exports=r},function(e,t,n){var r=n(19),i="object"==typeof self&&self&&self.Object===Object&&self,a=r||i||Function("return this")();e.exports=a},function(e,t,n){var r=n(33);e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},function(e,t,n){var r=n(39);e.exports=function(e,t){var n=e.__data__;return r(t)?n["string"==typeof t?"string":"hash"]:n.map}},function(e,t,n){var r=n(16),i=n(25);e.exports=function(e,t){var n=i(e,t);return r(n)?n:void 0}},function(e){e.exports=JSON.parse('{"a":"2.0.2"}')},function(e,t,n){var r=n(1).Symbol;e.exports=r},function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},function(e,t){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}},function(e,t,n){var r=n(10);e.exports=function(e){return e&&e.length?r(e):[]}},function(e,t,n){var r=n(11),i=n(45),a=n(50),o=n(51),s=n(52),c=n(8);e.exports=function(e,t,n){var l=-1,u=i,f=e.length,p=!0,d=[],m=d;if(n)p=!1,u=a;else if(f>=200){var g=t?null:s(e);if(g)return c(g);p=!1,u=o,m=new r}else m=t?[]:d;e:for(;++l<f;){var h=e[l],v=t?t(h):h;if(h=n||0!==h?h:0,p&&v==v){for(var b=m.length;b--;)if(m[b]===v)continue e;t&&m.push(v),d.push(h)}else u(m,v,n)||(m!==d&&m.push(v),d.push(h))}return d}},function(e,t,n){var r=n(12),i=n(43),a=n(44);function o(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new r;++t<n;)this.add(e[t])}o.prototype.add=o.prototype.push=i,o.prototype.has=a,e.exports=o},function(e,t,n){var r=n(13),i=n(38),a=n(40),o=n(41),s=n(42);function c(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=i,c.prototype.get=a,c.prototype.has=o,c.prototype.set=s,e.exports=c},function(e,t,n){var r=n(14),i=n(30),a=n(37);e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(a||i),string:new r}}},function(e,t,n){var r=n(15),i=n(26),a=n(27),o=n(28),s=n(29);function c(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=i,c.prototype.get=a,c.prototype.has=o,c.prototype.set=s,e.exports=c},function(e,t,n){var r=n(0);e.exports=function(){this.__data__=r?r(null):{},this.size=0}},function(e,t,n){var r=n(17),i=n(22),a=n(7),o=n(24),s=/^\[object .+?Constructor\]$/,c=Function.prototype,l=Object.prototype,u=c.toString,f=l.hasOwnProperty,p=RegExp("^"+u.call(f).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!a(e)||i(e))&&(r(e)?p:s).test(o(e))}},function(e,t,n){var r=n(18),i=n(7);e.exports=function(e){if(!i(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},function(e,t,n){var r=n(6),i=n(20),a=n(21),o=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":o&&o in Object(e)?i(e):a(e)}},function(e,t){var n="object"==typeof global&&global&&global.Object===Object&&global;e.exports=n},function(e,t,n){var r=n(6),i=Object.prototype,a=i.hasOwnProperty,o=i.toString,s=r?r.toStringTag:void 0;e.exports=function(e){var t=a.call(e,s),n=e[s];try{e[s]=void 0;var r=!0}catch(e){}var i=o.call(e);return r&&(t?e[s]=n:delete e[s]),i}},function(e,t){var n=Object.prototype.toString;e.exports=function(e){return n.call(e)}},function(e,t,n){var r,i=n(23),a=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";e.exports=function(e){return!!a&&a in e}},function(e,t,n){var r=n(1)["__core-js_shared__"];e.exports=r},function(e,t){var n=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return n.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},function(e,t){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},function(e,t,n){var r=n(0),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return i.call(t,e)?t[e]:void 0}},function(e,t,n){var r=n(0),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:i.call(t,e)}},function(e,t,n){var r=n(0);e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?"__lodash_hash_undefined__":t,this}},function(e,t,n){var r=n(31),i=n(32),a=n(34),o=n(35),s=n(36);function c(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=i,c.prototype.get=a,c.prototype.has=o,c.prototype.set=s,e.exports=c},function(e,t){e.exports=function(){this.__data__=[],this.size=0}},function(e,t,n){var r=n(2),i=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0)&&(n==t.length-1?t.pop():i.call(t,n,1),--this.size,!0)}},function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},function(e,t,n){var r=n(2);e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},function(e,t,n){var r=n(2);e.exports=function(e){return r(this.__data__,e)>-1}},function(e,t,n){var r=n(2);e.exports=function(e,t){var n=this.__data__,i=r(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this}},function(e,t,n){var r=n(4)(n(1),"Map");e.exports=r},function(e,t,n){var r=n(3);e.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},function(e,t){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},function(e,t,n){var r=n(3);e.exports=function(e){return r(this,e).get(e)}},function(e,t,n){var r=n(3);e.exports=function(e){return r(this,e).has(e)}},function(e,t,n){var r=n(3);e.exports=function(e,t){var n=r(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this}},function(e,t){e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},function(e,t){e.exports=function(e){return this.__data__.has(e)}},function(e,t,n){var r=n(46);e.exports=function(e,t){return!!(null==e?0:e.length)&&r(e,t,0)>-1}},function(e,t,n){var r=n(47),i=n(48),a=n(49);e.exports=function(e,t,n){return t==t?a(e,t,n):r(e,i,n)}},function(e,t){e.exports=function(e,t,n,r){for(var i=e.length,a=n+(r?1:-1);r?a--:++a<i;)if(t(e[a],a,e))return a;return-1}},function(e,t){e.exports=function(e){return e!=e}},function(e,t){e.exports=function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}},function(e,t){e.exports=function(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}},function(e,t){e.exports=function(e,t){return e.has(t)}},function(e,t,n){var r=n(53),i=n(54),a=n(8),o=r&&1/a(new r([,-0]))[1]==1/0?function(e){return new r(e)}:i;e.exports=o},function(e,t,n){var r=n(4)(n(1),"Set");e.exports=r},function(e,t){e.exports=function(){}},function(e,t,n){"use strict";n.r(t);var r=n(9),i=n.n(r);class a{static step0(e){return e>0?1:0}static step1(e){return e>=1?1:0}static linear(e){return e}static quad(e){return e*e}static cubic(e){return e*e*e}static poly(e){return t=>Math.pow(t,e)}static sin(e){return 1-Math.cos(e*Math.PI/2)}static circle(e){return 1-Math.sqrt(1-e*e)}static exp(e){return Math.pow(2,10*(e-1))}static elastic(e=1){const t=e*Math.PI;return e=>1-Math.pow(Math.cos(e*Math.PI/2),3)*Math.cos(e*t)}static back(e=1.70158){return t=>t*t*((e+1)*t-e)}static bounce(e=.5){return t=>Math.min((e=>7.5625*e*e)(t),(t=>30.25*e*Math.pow(t-6/11,2)+1-e)(t),(t=>121*e*e*Math.pow(t-9/11,2)+1-e*e)(t),(t=>484*e*e*e*Math.pow(t-10.5/11,2)+1-e*e*e)(t))}static in(e){return e}static out(e){return t=>1-e(1-t)}static inOut(e){return t=>t<.5?e(2*t)/2:1-e(2*(1-t))/2}}const o=a.poly(4),s=a.poly(5),c=(e,t,n)=>e(a.back(1.70158*t))(n),l=(e,t,n)=>e(a.elastic(t))(n),u=(e,t,n)=>e(a.bounce(t))(n),f={linear:a.linear,step(e,t){const n=function(e,t=1){if(e<2)throw new Error("steps must be > 2, got:"+e);const n=t/e;return Array.from({length:e},(e,t)=>t*n)}(e);return n[function(e,t,n){if(e<t[0])return 0;if(e>t[t.length-1])return t.length-1;for(var r=0,i=0,a=t.length-1;a-i!=1;)e>=t[r=i+Math.floor((a-i)/2)]?i=r:a=r;return n?a:i}(t,n,!1)]},easeInQuad:a.in(a.quad),easeOutQuad:a.out(a.quad),easeInOutQuad:a.inOut(a.quad),easeInCubic:a.in(a.cubic),easeOutCubic:a.out(a.cubic),easeInOutCubic:a.inOut(a.cubic),easeInQuart:a.in(o),easeOutQuart:a.out(o),easeInOutQuart:a.inOut(o),easeInQuint:a.in(s),easeOutQuint:a.out(s),easeInOutQuint:a.inOut(s),easeInSine:a.in(a.sin),easeOutSine:a.out(a.sin),easeInOutSine:a.inOut(a.sin),easeInExpo:a.in(a.exp),easeOutExpo:a.out(a.exp),easeInOutExpo:a.inOut(a.exp),easeInCirc:a.in(a.circle),easeOutCirc:a.out(a.circle),easeInOutCirc:a.inOut(a.circle),easeInBack:c.bind(null,a.in),easeOutBack:c.bind(null,a.out),easeInOutBack:c.bind(null,a.inOut),easeInElastic:l.bind(null,a.in),easeOutElastic:l.bind(null,a.out),easeInOutElastic:l.bind(null,a.inOut),easeInBounce:u.bind(null,a.in),easeOutBounce:u.bind(null,a.out),easeInOutBounce:u.bind(null,a.inOut)},p=Object.fromEntries(Object.entries(f).map(e=>[e[0],e[0]]));Object.freeze(p);const d=e=>{switch(e.easing){case p.easeInBack:case p.easeOutBack:case p.easeInOutBack:case p.easeInElastic:case p.easeOutElastic:case p.easeInOutElastic:return 1;case p.easeInBounce:case p.easeOutBounce:case p.easeInOutBounce:return.5;case p.step:return 5;default:return null}};var m=n(5);!function(){function e(e){var t=trimFloatNumber(e)+"";return t.includes(".")||(t+=".0"),t+"F"}function t(e){return Math.floor(e)}function n(e,t,n){return n*(t-e)+e}const r=["Forge 1.12 - 1.16","Fabric 1.15 - 1.16"],a=Object.fromEntries(r.map(e=>[e,e])),o={modSDK:"Forge 1.12 - 1.16",entityType:"Entity",javaPackage:"com.example.mod",animFileNamespace:"MODID",animFilePath:"animations/ANIMATIONFILE.json"};Object.freeze(o);let s=Object.assign({},o);const c=e=>{e.model.geckoSettings=s},l=e=>{e.model&&"object"==typeof e.model.geckoSettings?Object.assign(s,e.model.geckoSettings):s=Object.assign({},o)},u=(...e)=>{},g=(e="")=>e.includes("Back")||e.includes("Elastic")||e.includes("Bounce")||e===p.step;function h(e){const t=$(e).val();"-"!==t&&(Timeline.selected.forEach(e=>{e.easing=t}),updateKeyframeSelection())}function v(e){"-"!==$(e).val()&&Timeline.selected.forEach(t=>{const n=((e,t)=>{switch(e.easing){case p.easeInBack:case p.easeOutBack:case p.easeInOutBack:case p.easeInElastic:case p.easeOutElastic:case p.easeInOutElastic:case p.easeInBounce:case p.easeOutBounce:case p.easeInOutBounce:return parseFloat(t);case p.step:return Math.max(parseInt(t,10),2);default:return parseInt(t,10)}})(t,$(e).val().trim());t.easingArgs=[n]})}const b=(...e)=>{$("#keyframe_bar_easing").remove();var t=!1;Timeline.selected.forEach(e=>{!1===t?t=e.channel:t!==e.channel&&!0});const n=(e,t,n)=>{const r="function"==typeof e?e:n=>void 0===n[e]?t:n[e];if(Timeline.selected.length>1){const e=i()(Timeline.selected.map(r));return 1===e.length?e[0]:n}return r(Timeline.selected[0])||t},r=Timeline.keyframes.reduce((e,t)=>{e.has(t.animator)||e.set(t.animator,{});const n=e.get(t.animator);return n[t.channel]||(n[t.channel]=[]),n[t.channel].push(t),n[t.channel].sort((e,t)=>e.time<t.time?-1:e.time>t.time?1:0),e},new Map);if(Timeline.selected.length&&"animated_entity_model"===Format.id&&Timeline.selected.every(e=>e.animator instanceof BoneAnimator&&!(e=>r.get(e.animator)[e.channel].indexOf(e)<1)(e))){const e=n("easing","linear","null"),t=document.getElementById("keyframe");let r=document.createElement("div");t.appendChild(r),r.outerHTML='<div class="bar flex" id="keyframe_bar_easing">\n            <label class="tl" style="font-weight: bolder; min-width: 47px;">Easing</label>\n          </div>',r=document.getElementById("keyframe_bar_easing");let i=document.createElement("select");r.appendChild(i),i.outerHTML='<select class="focusable_input" id="keyframe_easing" style="flex: 1; margin-right: 9px;" oninput="updateKeyframeEasing(this)"></select>',i=document.getElementById("keyframe_easing");const s="null"!==e?p:Object.assign({},{null:"-"},p);for(var a in s){var o=s[a];const t=document.createElement("option");i.appendChild(t),t.outerHTML=`<option id="${a}" ${e===a?"selected":""}>${o}</option>`}const c=n(e=>{switch(e.easing){case p.easeInBack:case p.easeOutBack:case p.easeInOutBack:return"Overshoot";case p.easeInElastic:case p.easeOutElastic:case p.easeInOutElastic:case p.easeInBounce:case p.easeOutBounce:case p.easeInOutBounce:return"Bounciness";case p.step:return"Steps";default:return"N/A"}},null,null);if(Timeline.selected.every(e=>g(e.easing))&&null!==c){const e=n(d,null,null),[r]=n("easingArgs",[e],[e]);let i=document.createElement("div");t.appendChild(i),i.outerHTML=`<div class="bar flex" id="keyframe_bar_easing_arg1">\n              <label class="tl" style="font-weight: bolder; min-width: 90px;">${c}</label>\n              <input type="number" id="keyframe_easing_scale" class="dark_bordered code keyframe_input tab_target" value="${r}" oninput="updateKeyframeEasingArg(this)" style="flex: 1; margin-right: 9px;">\n            </div>`,i=document.getElementById("keyframe_bar_easing_arg1")}}},_=new Map,y=(e,t,n,r)=>{const i=t?e[t]:e;_.get(e)||_.set(e,{_pathAccessor:i}),_.get(e)[n]=i[n],i[n]=r};function x(e,t,r,i){const a=e.easing||"linear";if("animated_entity_model"!==Format.id)return _.get(Keyframe).getLerp.apply(this,arguments);let o=f[a];if(g(a)){const t=Array.isArray(e.easingArgs)&&e.easingArgs.length>0?e.easingArgs[0]:d(e);o=o.bind(null,t)}const s=o(r),c=this.calc(t),l=e.calc(t),u=n(c,l,s);if(Number.isNaN(u))throw new Error("batman");return u}function O(){const{easing:e,easingArgs:t}=this;let n=_.get(Keyframe).getArray.apply(this,arguments);return"animated_entity_model"===Format.id&&(n={vector:n,easing:e},g(e)&&(n.easingArgs=t)),n}function k(){const{easing:e,easingArgs:t}=this,n=_.get(Keyframe).getUndoCopy.apply(this,arguments);return"animated_entity_model"===Format.id&&(Object.assign(n,{easing:e}),g(e)&&(n.easingArgs=t)),n}function M(e){const t=Object.assign({},e);"animated_entity_model"===Format.id&&("object"==typeof t.values?(void 0!==t.values.easing&&Merge.string(this,t.values,"easing"),Array.isArray(t.values.easingArgs)&&(this.easingArgs=t.values.easingArgs),!Array.isArray(t.values)&&Array.isArray(t.values.vector)&&(t.values=t.values.vector)):(void 0!==t.easing&&Merge.string(this,t,"easing"),Array.isArray(t.easingArgs)&&(this.easingArgs=t.easingArgs)));const n=_.get(Keyframe).extend.apply(this,arguments);return n}function A(){return _.get(BarItems.reverse_keyframes).condition()&&"animated_entity_model"!==Format.id}let w,j,E,I;Plugin.register("animation_utils",{name:"GeckoLib Animation Utils",author:"Eliot Lash, Gecko",title:"GeckoLib Animation Utils",description:"This plugin lets you create animated java entities with GeckoLib. This plugin requires Blockbench 3.6 or higher. Learn about GeckoLib here: https://github.com/bernie-g/geckolib",icon:"movie_filter",version:m.a,min_version:"3.6",variant:"both",onload(){Codecs.project.on("compile",c),Codecs.project.on("parse",l),Blockbench.on("display_animation_frame",u),Blockbench.on("update_keyframe_selection",b),y(Keyframe,"prototype","getLerp",x),y(Keyframe,"prototype","getArray",O),y(Keyframe,"prototype","getUndoCopy",k),y(Keyframe,"prototype","extend",M),y(BarItems.reverse_keyframes,null,"condition",A),y(global,null,"updateKeyframeEasing",h),y(global,null,"updateKeyframeEasingArg",v),E=Animation.prototype.menu.structure.find(e=>"menu.animation.loop"===e.name).children.find(e=>"menu.animation.loop.hold"===e.name),I=E.condition,E.condition=()=>"animated_entity_model"!==Format.id,w=new Action({id:"export_animated_entity_model",name:"Export Animated Java Entity",icon:"archive",description:"Export your java animated model as a model for GeckoLib.",category:"file",condition:()=>"animated_entity_model"===Format.id,click:function(){F.export()}}),MenuBar.addAction(w,"file.export"),j=new Action("gecko_settings",{name:"Animated Entity Settings...",description:"Customize animated entity export.",icon:"info",condition:()=>"animated_entity_model"===Format.id,click:function(){var e=new Dialog({id:"project",title:"Animated Entity Settings",width:540,lines:[`<b class="tl"><a href="https://github.com/bernie-g/geckolib">GeckoLib</a> Animation Utils v${m.a}</b>`],form:{modSDK:{label:"Modding SDK",type:"select",default:s.modSDK,options:a},entityType:{label:"Entity Type",value:s.entityType},javaPackage:{label:"Java Package",value:s.javaPackage},animFileNamespace:{label:"Animation File Namespace",value:s.animFileNamespace},animFilePath:{label:"Animation File Path",value:s.animFilePath}},onConfirm:function(t){Object.assign(s,t),e.hide()}});e.show()}}),MenuBar.addAction(j,"file.1")},onunload(){Codecs.project.events.compile.remove(c),Codecs.project.events.parse.remove(l),Blockbench.removeListener("display_animation_frame",u),Blockbench.removeListener("update_keyframe_selection",b),w.delete(),j.delete(),_.forEach(e=>{Object.keys(e).forEach(t=>{t.startsWith("_")||(e._pathAccessor[t]=e[t])})}),_.clear(),E.condition=I,console.clear()}});const B={1.15:{name:"1.15",flip_y:!0,integer_size:!1,file:'// Made with Blockbench %(bb_version)\n// Exported for Minecraft version 1.12.2 or 1.15.2 (same format for both) for entity models animated with GeckoLib\n// Paste this class into your mod and follow the documentation for GeckoLib to use animations. You can find the documentation here: https://github.com/bernie-g/geckolib\n// Blockbench plugin created by Gecko\npackage %(javaPackage);\n\n%(imports)\n\npublic class %(identifier) extends AnimatedEntityModel<%(entityType)> {\n\n    %(fields)\n\n    public %(identifier)()\n    {\n        textureWidth = %(texture_width);\n    textureHeight = %(texture_height);\n    %(content)\n\n    %(renderers)\n  }\n\n\n    @Override\n    public ResourceLocation getAnimationFileLocation()\n    {\n        return new ResourceLocation("%(animFileNamespace)", "%(animFilePath)");\n    }\n}',field:"private final AnimatedModelRenderer %(bone);",bone:'%(bone) = new AnimatedModelRenderer(this);\n%(bone).setRotationPoint(%(x), %(y), %(z));\n?(has_parent)%(parent).addChild(%(bone));\n?(has_rotation)setRotationAngle(%(bone), %(rx), %(ry), %(rz));\n%(cubes)\n%(bone).setModelRendererName("%(bone)");\nthis.registerModelRenderer(%(bone));',renderer:"this.rootBones.add(%(bone));",cube:"%(bone).setTextureOffset(%(uv_x), %(uv_y)).addBox(%(x), %(y), %(z), %(dx), %(dy), %(dz), %(inflate), %(mirror));"},get(e,t=Project.modded_entity_version){let n=B[t][e];return"string"==typeof n&&(n=n.replace(/\t\t\t/g,"")),n},keepLine:e=>e.replace(/\?\(\w+\)/,""),getVariableRegex:e=>new RegExp(`%\\(${e}\\)`,"g")};function T(){return Project.geometry_name.replace(/[\s-]+/g,"_")||"animated_entity_model"}var F=new Codec("animated_entity_model",{name:"Animated Java Class",extension:"java",remember:!0,compile(n){let r=B.getVariableRegex,i=T(),a=getAllGroups(),o=[];Cube.all.forEach(e=>{"root"==e.parent&&o.push(e)}),o.length&&a.push({name:"bb_main",rotation:[0,0,0],origin:[0,0,0],parent:"root",children:o});let c=B.get("file");return c=c.replace(r("bb_version"),Blockbench.version),c=c.replace(r("javaPackage"),s.javaPackage),c=c.replace(r("imports"),(()=>{switch(s.modSDK){case"Forge 1.12 - 1.16":return"import net.minecraft.util.ResourceLocation;\nimport software.bernie.geckolib.animation.model.AnimatedEntityModel;\nimport software.bernie.geckolib.animation.render.AnimatedModelRenderer;";case"Fabric 1.15 - 1.16":return"import software.bernie.geckolib.forgetofabric.ResourceLocation;\nimport software.bernie.geckolib.animation.model.AnimatedEntityModel;\nimport software.bernie.geckolib.animation.render.AnimatedModelRenderer;";default:throw new Error("Unrecognized mod SDK:",s.modSDK)}})()),c=c.replace(r("identifier"),i),c=c.replace(r("entityType"),s.entityType),c=c.replace(r("texture_width"),Project.texture_width),c=c.replace(r("texture_height"),Project.texture_height),c=c.replace(r("animFileNamespace"),s.animFileNamespace),c=c.replace(r("animFilePath"),s.animFilePath),c=c.replace(r("fields"),()=>{let e=[];for(var t of a){if(t instanceof Group==!1||!t.export)continue;let n=B.get("field").replace(r("bone"),t.name);e.push(n)}return e.join("\n\t")}),c=c.replace(r("content"),()=>{let n=[];for(var i of a){if(i instanceof Group==!1||!i.export)continue;let a=B.get("bone").replace(r("bone"),i.name).replace(/\n\?\(has_rotation\).+/,i.rotation.allEqual(0)?"":B.keepLine);a=a.replace(r("rx"),e(Math.degToRad(-i.rotation[0]))).replace(r("ry"),e(Math.degToRad(-i.rotation[1]))).replace(r("rz"),e(Math.degToRad(i.rotation[2])));var o=i.origin.slice();i.parent instanceof Group&&o.V3_subtract(i.parent.origin),o[0]*=-1,B.get("flip_y")&&(o[1]*=-1,i.parent instanceof Group==!1&&(o[1]+=24)),a=a.replace(r("x"),e(o[0])).replace(r("y"),e(o[1])).replace(r("z"),e(o[2])).replace(/\n\?\(has_parent\).+/,i.parent instanceof Group?B.keepLine:"").replace(r("parent"),i.parent.name).replace(r("cubes"),()=>{let n=[];for(var a of i.children){if(a instanceof Cube==!1||!a.export)continue;let o=B.get("cube").replace(r("bone"),i.name).replace(r("uv_x"),t(a.uv_offset[0])).replace(r("uv_y"),t(a.uv_offset[1])).replace(r("inflate"),e(a.inflate)).replace(r("mirror"),a.mirror_uv);o=B.get("flip_y")?o.replace(r("x"),e(i.origin[0]-a.to[0])).replace(r("y"),e(-a.from[1]-a.size(1)+i.origin[1])).replace(r("z"),e(a.from[2]-i.origin[2])):o.replace(r("x"),e(i.origin[0]-a.to[0])).replace(r("y"),e(a.from[1]-i.origin[1])).replace(r("z"),e(a.from[2]-i.origin[2])),o=B.get("integer_size")?o.replace(r("dx"),t(a.size(0,!0))).replace(r("dy"),t(a.size(1,!0))).replace(r("dz"),t(a.size(2,!0))):o.replace(r("dx"),e(a.size(0,!0))).replace(r("dy"),e(a.size(1,!0))).replace(r("dz"),e(a.size(2,!0))),n.push(o)}return n.join("\n")}).replace(/\n/g,"\n\t\t"),n.push(a)}return n.join("\n\n\t\t")}),c=c.replace(r("renderers"),()=>{let e=[];for(var t of a){if(t instanceof Group==!1||!t.export)continue;if(!B.get("render_subgroups")&&t.parent instanceof Group)continue;let n=B.get("renderer").replace(r("bone"),t.name);e.push(n)}return e.join("\n\t\t")}),this.dispatchEvent("compile",{model:c,options:n}),c},parse(e,t,n){this.dispatchEvent("parse",{model:e});var r=[];function i(e,t){var n=(e=e.replace(/\(/g,"\\(").replace(/\)/g,"\\)").replace(/\./g,"\\.")).split("$"),r=[],i=0,a=0;for(var s of n){if(0==a){if(null==(l=new RegExp("^"+s).exec(t)))return;i=l[0].length}else{var c=s.substr(0,1);s=s.substr(1);var l,u="";switch(c){case"v":u="^[a-zA-Z_][a-zA-Z0-9_]+";break;case"i":u="^-?\\d+";break;case"f":u="^-?\\d+\\.?\\d*F";break;case"d":u="^-?\\d+\\.?\\d*";break;case"b":u="^true|false"}if(null==(l=new RegExp(u+s).exec(t.substr(i))))return;var f=new RegExp(u).exec(t.substr(i))[0];switch(c){case"v":r.push(f);break;case"i":r.push(parseInt(f));break;case"f":case"d":r.push(parseFloat(f.replace(/F$/,"")));break;case"b":r.push("true"==f)}i+=l[0].length}a++}return o=r,!0}e.split("\n").forEach(e=>{(e=e.replace(/\/\*[^(\*\/)]*\*\/|\/\/.*/g,"").trim().replace(/;$/,""))&&r.push(e)});var a,o,s,c=0,l={};r.forEach(e=>{if(0==c)/^public class/.test(e)&&(c=1,a=e.split(/[\s<>()\.]+/g)[2]);else if(1==c)if("AnimatedModelRenderer"==(e=e.replace(/public |static |final |private |void /g,"").trim()).substr(0,13)||"RendererModel"==e.substr(0,13)){let t=e.split(" ")[1];l[t]=new Group({name:t,origin:[0,24,0]}).init()}else e.substr(0,a.length)==a&&(c=2);else if(2==c)if(e=e.replace(/^this\./,""),o=void 0,"}"==e)c--;else if(i("textureWidth = $i",e))Project.texture_width=o[0];else if(i("textureHeight = $i",e))Project.texture_height=o[0];else if(i("super($v, $i, $i)",e))Project.texture_width=o[1],Project.texture_height=o[2];else if(i("AnimatedModelRenderer $v = new AnimatedModelRenderer(this, $i, $i)",e)||i("RendererModel $v = new RendererModel(this, $i, $i)",e)||i("$v = new AnimatedModelRenderer(this, $i, $i)",e)||i("$v = new RendererModel(this, $i, $i)",e))l[o[0]]||(l[o[0]]=new Group({name:o[0],origin:[0,24,0]}).init()),s=[o[1],o[2]];else if(i("$v = new AnimatedModelRenderer(this)",e))l[o[0]]||(l[o[0]]=new Group({name:o[0],origin:[0,0,0]}).init());else if(i("$v.setRotationPoint($f, $f, $f)",e)){var t=l[o[0]];t&&(t.extend({origin:[-o[1],24-o[2],o[3]]}),t.children.forEach(e=>{e instanceof Cube&&(e.from[0]+=t.origin[0],e.to[0]+=t.origin[0],e.from[1]+=t.origin[1]-24,e.to[1]+=t.origin[1]-24,e.from[2]+=t.origin[2],e.to[2]+=t.origin[2])}))}else if(i("$v.addChild($v)",e.replace(/\(this\./g,"("))){var n=l[o[1]],r=l[o[0]];n.addTo(r),n.origin.V3_add(r.origin),n.origin[1]-=24,n.children.forEach(e=>{e instanceof Cube&&(e.from[0]+=r.origin[0],e.to[0]+=r.origin[0],e.from[1]+=r.origin[1]-24,e.to[1]+=r.origin[1]-24,e.from[2]+=r.origin[2],e.to[2]+=r.origin[2])})}else if(i("$v.cubeList.add(new ModelBox($v, $i, $i, $f, $f, $f, $i, $i, $i, $f, $b))",e)){var u=l[o[0]];(f=new Cube({name:o[0],uv_offset:[o[2],o[3]],from:[u.origin[0]-o[4]-o[7],u.origin[1]-o[5]-o[8],u.origin[2]+o[6]],inflate:o[10],mirror_uv:o[11]})).extend({to:[f.from[0]+Math.floor(o[7]),f.from[1]+Math.floor(o[8]),f.from[2]+Math.floor(o[9])]}),f.addTo(l[o[0]]).init()}else if(i("$v.addBox($f, $f, $f, $i, $i, $i)",e)||i("$v.addBox($f, $f, $f, $i, $i, $i, $v)",e)||i("$v.addBox($f, $f, $f, $i, $i, $i, $f)",e)){u=l[o[0]];(f=new Cube({name:o[0],uv_offset:s,from:[u.origin[0]-o[1]-o[4],u.origin[1]-o[2]-o[5],u.origin[2]+o[3]],inflate:"number"==typeof o[7]?o[7]:0,mirror_uv:u.mirror_uv})).extend({to:[f.from[0]+Math.floor(o[4]),f.from[1]+Math.floor(o[5]),f.from[2]+Math.floor(o[6])]}),f.addTo(l[o[0]]).init()}else if(i("$v.setTextureOffset($i, $i).addBox($f, $f, $f, $f, $f, $f, $f, $b)",e)){var f;u=l[o[0]];(f=new Cube({name:o[0],uv_offset:[o[1],o[2]],from:[u.origin[0]-o[3]-o[6],u.origin[1]-o[4]-o[7],u.origin[2]+o[5]],inflate:o[9],mirror_uv:o[10]})).extend({to:[f.from[0]+Math.floor(o[6]),f.from[1]+Math.floor(o[7]),f.from[2]+Math.floor(o[8])]}),f.addTo(l[o[0]]).init()}else if(i("setRotationAngle($v, $f, $f, $f)",e)){(u=l[o[0]])&&u.extend({rotation:[-Math.radToDeg(o[1]),-Math.radToDeg(o[2]),Math.radToDeg(o[3])]})}else if(i("setRotation($v, $f, $f, $f)",e)){(u=l[o[0]])&&u.extend({rotation:[-Math.radToDeg(o[1]),-Math.radToDeg(o[2]),Math.radToDeg(o[3])]})}else if(i("setRotateAngle($v, $f, $f, $f)",e)){(u=l[o[0]])&&u.extend({rotation:[-Math.radToDeg(o[1]),-Math.radToDeg(o[2]),Math.radToDeg(o[3])]})}else if(i("$v.rotateAngleX = $f",e)){(u=l[o[0]])&&(u.rotation[0]=-Math.radToDeg(o[1]))}else if(i("$v.rotateAngleY = $f",e)){(u=l[o[0]])&&(u.rotation[1]=-Math.radToDeg(o[1]))}else if(i("$v.rotateAngleZ = $f",e)){(u=l[o[0]])&&(u.rotation[2]=Math.radToDeg(o[1]))}else if(i("$v.mirror = $b",e)){(u=l[o[0]]).mirror_uv=o[1],u.children.forEach(e=>{e.mirror_uv=o[1]})}}),Canvas.updateAll()},fileName:()=>T()});F.templates=B;var P=new ModelFormat({id:"animated_entity_model",name:"Animated Java Entity",description:"Animated Entity for Java mods using GeckoLib",icon:"icon-format_java",codec:F,box_uv:!0,single_texture:!0,bone_rig:!0,centered_grid:!0,integer_size:!0,animation_mode:!0});F.format=P}()}]);